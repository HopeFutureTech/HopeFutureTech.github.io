# 静态文件版本控制说明

## 概述

本项目已实现静态文件版本控制，确保用户总是获取最新的文件，避免浏览器缓存问题。

## 版本控制机制

### 1. 版本号格式
- 当前版本：`1.0.0`
- 格式：`主版本.次版本.修订版本`

### 2. 受版本控制的文件类型
- CSS文件：`.css`
- JavaScript文件：`.js`
- 图片文件：`.png`, `.jpg`, `.jpeg`, `.webp`, `.svg`
- 图标文件：`.ico`

### 3. 版本控制方式
所有静态资源URL都会添加版本号参数：
```
原URL: css/font-awesome.min.css
版本化URL: css/font-awesome.min.css?v=1.0.0
```

## 文件结构

```
├── js/
│   ├── version.js          # 版本控制配置文件
│   ├── i18n.js            # 多语言翻译文件
│   └── language-switcher.js # 语言切换脚本
├── build.js               # 构建脚本
└── VERSION_CONTROL.md     # 本文档
```

## 使用方法

### 1. 更新版本号
编辑 `build.js` 文件中的版本号：
```javascript
const VERSION_CONFIG = {
    version: '1.0.1',  // 修改这里的版本号
    buildTime: new Date().toISOString().split('T')[0]
};
```

### 2. 运行构建脚本
```bash
node build.js
```

### 3. 在HTML中使用版本控制
所有HTML文件中的静态资源引用都已添加版本号：
```html
<!-- CSS文件 -->
<link rel="stylesheet" href="css/font-awesome.min.css?v=1.0.0">

<!-- JavaScript文件 -->
<script src="js/i18n.js?v=1.0.0"></script>

<!-- 图片文件 -->
<img src="imgs/xiwangxue.webp?v=1.0.0" alt="希望学">
```

## 版本控制的好处

### 1. 缓存控制
- 当版本号更新时，浏览器会重新下载文件
- 避免用户看到过期的内容

### 2. 部署安全
- 确保用户获取最新版本的文件
- 减少因缓存导致的部署问题

### 3. 调试便利
- 可以快速识别当前使用的文件版本
- 便于问题排查和回滚

## 最佳实践

### 1. 版本号命名规范
- 主版本：重大功能更新或架构变更
- 次版本：新功能添加
- 修订版本：Bug修复和小改动

### 2. 更新频率
- 每次部署前更新版本号
- 重大更新时增加主版本号
- 日常更新使用修订版本号

### 3. 测试建议
- 更新版本号后测试所有页面
- 确认静态资源正确加载
- 检查浏览器开发者工具中的网络请求

## 故障排除

### 1. 文件未更新
- 检查版本号是否正确更新
- 确认构建脚本已运行
- 清除浏览器缓存

### 2. 版本号不匹配
- 检查 `js/version.js` 文件内容
- 确认所有HTML文件中的版本号一致
- 重新运行构建脚本

### 3. 缓存问题
- 强制刷新页面（Ctrl+F5）
- 清除浏览器缓存
- 检查CDN缓存设置

## 相关文件

- `js/version.js` - 版本控制配置
- `build.js` - 构建脚本
- 所有HTML文件 - 已添加版本号参数 